@{
    ViewData["Title"] = "Population Map";
}

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin="" />

<style>
    #map {
        height: 80vh;
        width: 100%;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    .info {
        padding: 6px 8px;
        font: 14px/16px Arial, Helvetica, sans-serif;
        background: white;
        background: rgba(255,255,255,0.8);
        box-shadow: 0 0 15px rgba(0,0,0,0.2);
        border-radius: 5px;
    }
    .info h4 {
        margin: 0 0 5px;
        color: #777;
    }
    .legend {
        line-height: 18px;
        color: #555;
    }
    .legend i {
        width: 18px;
        height: 18px;
        float: left;
        margin-right: 8px;
        opacity: 0.7;
    }
    #controls {
        position: absolute;
        top: 20px;
        right: 20px;
        z-index: 1000;
        background: rgba(255, 255, 255, 0.9);
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        width: 280px;
    }
    #comparison-container {
        display: none;
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 1000;
        background: rgba(255, 255, 255, 0.95);
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        max-width: 90%;
        overflow-x: auto;
    }
    .comparison-card {
        background: #fff;
        border: none;
        border-radius: 12px;
        box-shadow: 0 6px 15px rgba(0,0,0,0.1);
        padding: 15px;
        margin-right: 15px;
        min-width: 250px;
        max-width: 320px;
        transition: transform 0.2s;
    }
    .comparison-card:hover {
        transform: translateY(-5px);
    }
    .vs-card {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background: transparent;
        border: none;
        padding: 15px;
        min-width: 200px;
    }
    .vs-text {
        font-size: 1.5rem;
        font-weight: bold;
        color: #777;
        margin-bottom: 10px;
    }
    .diff-badge {
        font-size: 0.9rem;
        padding: 5px 10px;
        border-radius: 20px;
        margin-bottom: 5px;
        text-align: center;
        width: 100%;
    }
    .diff-badge.bg-population {
        background-color: #e3f2fd;
        color: #0d47a1;
    }
    .diff-badge.bg-crime {
        background-color: #ffebee;
        color: #b71c1c;
    }
</style>

<div class="container-fluid mt-3 position-relative">
    <div class="row">
        <div class="col-12 position-relative">
            <h2 class="mb-3 text-center" id="mapTitle">Bulgaria Population Density</h2>

            <div id="map" style="position: relative;">
                <div id="controls">
                    <h5>Data Settings</h5>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="dataSource" id="viewPopulation" value="population" checked>
                        <label class="form-check-label" for="viewPopulation">Population</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="dataSource" id="viewCrime" value="crime">
                        <label class="form-check-label" for="viewCrime">Crime Statistics</label>
                    </div>

                    <div id="crimeFilterContainer" class="mt-2" style="display: none;">
                        <label for="crimeCategorySelect">Crime Category:</label>
                        <select id="crimeCategorySelect" class="form-select form-select-sm mb-2">
                            <option value="">All Categories</option>
                        </select>

                        <div class="form-check form-switch mb-1">
                            <input class="form-check-input" type="checkbox" id="enableYearFilter">
                            <label class="form-check-label" for="enableYearFilter">Filter by Year</label>
                        </div>
                        <div id="yearSliderContainer" style="display: none;">
                            <label for="yearSlider" class="form-label mb-0" id="yearLabel">Year: 2023</label>
                            <input type="range" class="form-range" min="2021" max="2024" step="1" id="yearSlider" value="2023">
                            <div class="d-flex justify-content-between text-muted" style="font-size: 0.75rem;">
                                <span>2021</span>
                                <span>2022</span>
                                <span>2023</span>
                                <span>2024</span>
                            </div>
                        </div>
                    </div>

                    <hr />

                    <h5>Mode</h5>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="mapMode" id="modeView" value="view" checked>
                        <label class="form-check-label" for="modeView">View Map</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="mapMode" id="modeCompareAll" value="compareAll">
                        <label class="form-check-label" for="modeCompareAll">Compare Multiple Cities</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="mapMode" id="modeCompareTwo" value="compareTwo">
                        <label class="form-check-label" for="modeCompareTwo">Compare 2 Cities</label>
                    </div>
                </div>

                <div id="comparison-container">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <h5 class="m-0">City Comparison</h5>
                        <button id="clearComparisonBtn" class="btn btn-sm btn-outline-danger">Clear</button>
                    </div>
                    <div id="comparison-cards" class="d-flex flex-nowrap" style="overflow-x: auto;">
                        <!-- Cards injected here -->
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        crossorigin=""></script>
<script src="~/js/map.js" asp-append-version="true"></script>
